<html>
<head>
<title>Stack The Blocks</title>

<script src ="https://cdn.jsdelivr.net/npm/phaser@3.22.0/dist/phaser.min.js"></script>

</head>
<body>
<h1>Crate Towers</h1>
<script>
    var timer = 120;
    var timerText;
    var tween;

    var config = {
        type: Phaser.AUTO,
        width: 640,
        height: 960,
        physics: {
            default: 'matter',
        },
        scene: {
            preload: preload,
            create: create,
            update: update
        }
    };
    
    var game = new Phaser.Game(config);
    
    function preload ()
    {
        this.load.image('air', 'assets/air.png');
        this.load.image('box', 'assets/box.png');
        this.load.image('dirt', 'assets/dirt.png');
        this.load.image('dirt2', 'assets/dirt2.png');
        this.load.image('grass', 'assets/grass.png');
        this.load.image('grass2', 'assets/grass2.png');
        this.load.image('box', 'assets/box.png')

    }

    function countDown () {

        timer = timer - 1;
        
        timerText.setText('Time: ' + timer);

    };


    function create ()
    {

    this.cursors = this.input.keyboard.createCursorKeys();

        var air = this.add.image(400, 300, 'air');
        air.displayWidth = game.config.width*2;
        air.displayHeight = game.config.height*2;



        var dirt2 = this.add.image(320, 960, 'dirt2');
        dirt2.displayWidth = game.config.width*.5;
        dirt2.displayHeight = game.config.height*.6;

        var grass2 = this.matter.add.image(320, 700, 'grass2', null, {isStatic: true});
        grass2.displayWidth = game.config.width*.5;
 
        this.player =  this.matter.add.image(30, 100, 'box');
        this.player.setIgnoreGravity(true);
        this.player.setBounce(1);
        
        var clock = this.time.addEvent({repeat: 119, delay: 10000000, callback: countDown});

        
        timerText = this.add.text(16, 16, 'time: 120', { fontSize: '32px', fill: '#000' }); 


        tween = this.tweens.add({
            targets: this.player,
            x:610,
            duration:1200,
            ease:'Expo.Solid',
            repeat:-1,
            yoyo:true,

        });

        this.matter.world.on('collisionstart', function(event, thingA, thingB) {
             console.log('hit')
            console.count('bounces')
        });
    }

    function update ()
    {
        if (this.cursors.space.isDown)
        {
            this.player.setIgnoreGravity(false);
            tween.stop();
        }


        if (timer  < 1)
        {
            alert('game over');
        };
    };

</script>
</body>
</html>